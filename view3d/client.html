<!doctype html>
<html>
  <head>
    <title>Socket.IO single test</title>
    <style>
      * { margin: 0; padding: 0; box-sizing: border-box; }
      body { font: 13px Helvetica, Arial; }
    </style>
  </head>
  <body>
    <p id="">X <a href="#" id="x-plus">+</a>/<a href="#" id="x-minus">-</a></p>
    <p id="">Y <a href="#" id="y-plus">+</a>/<a href="#" id="y-minus">-</a></p>
    <p id="">Z <a href="#" id="z-plus">+</a>/<a href="#" id="z-minus">-</a></p>
    <p id="reset"><a href="#" id="reset">Reset</a></p>
    <p>
      <input type="text" id="x"><br />
      <input type="text" id="y"><br />
      <input type="text" id="z"><br />
    </p>
    <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
    <script>
      var socket = io();
      var movement = 500;
      var accoffset = 200;
      $( "#x-plus" ).click(function() {
        socket.emit('x-delta', movement);
      });
      $( "#x-minus" ).click(function() {
        socket.emit('x-delta', -movement);
      });
      $( "#y-plus" ).click(function() {
        socket.emit('y-delta', movement);
      });
      $( "#y-minus" ).click(function() {
        socket.emit('y-delta', -movement);
      });
      $( "#z-plus" ).click(function() {
        socket.emit('z-delta', movement);
      });
      $( "#z-minus" ).click(function() {
        socket.emit('z-delta', -movement);
      });
      $( "#reset" ).click(function() {
        socket.emit('reset', true);
      });
      $('#x').change(function (){
        socket.emit('x', $('#x').val());
      });
      $('#y').change(function (){
        socket.emit('y', $('#y').val());
      });
      $('#z').change(function (){
        socket.emit('z', $('#z').val());
      });

      socket.on('x', function(msg){
        $('#x').val(msg)
      });
      socket.on('y', function(msg){
        $('#y').val(msg)
      });
      socket.on('z', function(msg){
        $('#z').val(msg)
      });
      window.ondevicemotion = function(event) {
        socket.emit('x', Math.round(event.accelerationIncludingGravity.x * accoffset / 10) * 10);
        socket.emit('y', Math.round(event.accelerationIncludingGravity.y * accoffset / 10) * 10);
        socket.emit('z', Math.round(event.accelerationIncludingGravity.z * accoffset / 10) * 10);
      }
    </script>
  </body>
</html>
